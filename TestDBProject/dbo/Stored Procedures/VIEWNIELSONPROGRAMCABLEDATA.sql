CREATE PROC VIEWNIELSONPROGRAMCABLEDATA

AS

BEGIN





--SELECT * FROM PROGRAMNETWORKDATA 

--WHERE SUBSTRING(VALUE,11,1)=0

--AND SUBSTRING(VALUE,42,2)=00

--AND (SUBSTRING(VALUE,97,1)=NULL OR (SUBSTRING(VALUE,97,1)=''))

--AND SUBSTRING(VALUE,85,1)='D'



SELECT 
SUBSTRING([Value],71,6)[STATION CODE],

SUBSTRING([Value],44,7)[AIR DATE], 

SUBSTRING([Value],86,4)[START TIME],

SUBSTRING([Value],278,4)[EVENT DURATION],

(CONVERT(INT,SUBSTRING([Value],86,4))+CONVERT(INT,SUBSTRING([Value],278,4))-1)[END TIME],

SUBSTRING([Value],115,25)[PROGRAM NAME]

FROM [ProgramCableData] 

WHERE SUBSTRING([Value],11,1)=0

AND SUBSTRING([Value],42,2)=00

--AND (SUBSTRING(VALUE,97,1)=NULL OR (SUBSTRING(VALUE,97,1)=''))

AND SUBSTRING([Value],85,1)='D'

AND SUBSTRING([Value],1,2)='04'



SELECT 

SUBSTRING([Value],71,6)[STATION],

SUBSTRING([Value],44,7)[AIR DATE], 

SUBSTRING([Value],86,4)[START TIME],

SUBSTRING([Value],254,6)[FIRST QUARTER HOUR DURATION],

SUBSTRING([Value],303,6)[SECOND QUARTER HOUR DURATION],

''[ENDTIME],

SUBSTRING([Value],260,9)[HHFIRST],

SUBSTRING([Value],309,9)[HHSECOND]

FROM [ProgramCableData] 

WHERE SUBSTRING([Value],11,1)=0

AND SUBSTRING([Value],42,2)=00

AND (SUBSTRING([Value],97,1)=NULL OR (SUBSTRING([Value],97,1)=''))

AND SUBSTRING([Value],85,1)='H'

AND SUBSTRING([Value],81,2)>0

AND SUBSTRING([Value],1,2)='05'



SELECT 

SUBSTRING([Value],15,6)[CHANNEL/STATION],

SUBSTRING([Value],44,7)[AIR DATE], 

SUBSTRING([Value],86,4)[START TIME],

''[ENDTIME],

SUBSTRING([Value],92,3)[DEMOGRAPHIC GROUP ID],

SUBSTRING([Value],116,9)[FC2_5],

SUBSTRING([Value],125,9)[FC6_8],

SUBSTRING([Value],134,9)[FC9_11],

SUBSTRING([Value],143,9)[FT12_14],

SUBSTRING([Value],152,9)[FT15_17],

SUBSTRING([Value],161,9)[F18_20],

SUBSTRING([Value],170,9)[F21_24],

SUBSTRING([Value],179,9)[F25_29],

SUBSTRING([Value],188,9)[F30_34],

SUBSTRING([Value],197,9)[F30_34],

SUBSTRING([Value],206,9)[F35_39],

SUBSTRING([Value],215,9)[F40_44],

SUBSTRING([Value],224,9)[F45_49],

SUBSTRING([Value],233,9)[F50_54],

SUBSTRING([Value],242,9)[F55_64],

SUBSTRING([Value],251,9)[F65PLUS],

SUBSTRING([Value],260,9)[MC2_5],

SUBSTRING([Value],269,9)[MC6_8],

SUBSTRING([Value],278,9)[MC9_11],

SUBSTRING([Value],287,9)[MT12_14],

'FOR GROUP ID 021'[021 GROUP ID ],

SUBSTRING([Value],116,9)[M18_20],

SUBSTRING([Value],125,9)[M21_24],

SUBSTRING([Value],134,9)[M25_29],

SUBSTRING([Value],143,9)[M30_34],

SUBSTRING([Value],152,9)[M35_39],

SUBSTRING([Value],161,9)[M40_44],

SUBSTRING([Value],170,9)[M45_49],

SUBSTRING([Value],179,9)[M50_54],

SUBSTRING([Value],188,9)[M55_64],

SUBSTRING([Value],197,9)[M65PLUS]

FROM [ProgramCableData] 

WHERE SUBSTRING([Value],11,1)=0

AND SUBSTRING([Value],42,2)=00

AND (SUBSTRING([Value],97,1)=NULL OR (SUBSTRING([Value],97,1)=''))

AND SUBSTRING([Value],85,1)='P'

AND SUBSTRING([Value],83,2)>0

AND SUBSTRING([Value],95,1)=0

AND SUBSTRING([Value],1,2)='05'



END
